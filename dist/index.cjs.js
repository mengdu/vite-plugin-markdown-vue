"use strict";var e=Object.defineProperty,n=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(n,t,r)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,o=(e,o)=>{for(var s in o||(o={}))t.call(o,s)&&i(e,s,o[s]);if(n)for(var s of n(o))r.call(o,s)&&i(e,s,o[s]);return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports[Symbol.toStringTag]="Module";var s=require("@rollup/pluginutils"),l=require("markdown-it"),c=require("highlight.js"),a=require("markdown-it-anchor"),u=require("uslug"),p=require("markdown-it-container"),m=require("@vue/compiler-sfc");function d(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=d(l),h=d(c),$=d(a),g=d(u),v=d(p),x=e=>{e.use(v.default,"tip"),e.use(v.default,"warning"),e.use(v.default,"spoiler",{validate:function(e){return e.trim().match(/^spoiler\s+(.*)$/)},render:function(n,t){var r=n[t].info.trim().match(/^spoiler\s+(.*)$/);return 1===n[t].nesting?"<details><summary>"+e.utils.escapeHtml(r[1])+"</summary>\n":"</details>\n"}}),e.use(v.default,"demo",{validate:e=>e.trim().match(/^demo\s*(.*)$/),render(n,t){const r=n[t].info.trim().match(/^demo\s*(.*)$/);if(1===n[t].nesting){const i=r&&r.length>1?r[1]:"",o="fence"===n[t+1].type?n[t+1].content:"";return`<demo-block>\n          ${i?`<div>${e.render(i)}</div>`:""}\n          \x3c!--element-demo: ${o}:element-demo--\x3e`}return"</demo-block>"}});const n=e.renderer.rules.fence;e.renderer.rules.fence=(e,t,r,i,o)=>{const s=e[t],l=e[t-1],c=l&&1===l.nesting&&l.info.trim().match(/^demo\s*(.*)$/);return/^html/.test(s.info)&&c?`<template #highlight>${n(e,t,r,i,o)}</template>`:n(e,t,r,i,o)}};const y=/{([\d,-]+)}/,b=/^<pre .*?><code>/;var k=e=>{const n=e.renderer.rules.fence;e.renderer.rules.fence=(...e)=>{const[t,r,i]=e,o=t[r];if(!o.lineNumbers){const t=o.info;if(!t||!y.test(t))return n(...e);const r=t.replace(y,"").trim();o.info=r,o.lineNumbers=y.exec(t)[1].split(",").map((e=>e.split("-").map((e=>parseInt(e,10)))))}const s=i.highlight?i.highlight(o.content,o.info):o.content;return`<div class="hljs-diff-block"><div class="hljs-lines">${s.replace(b,"").split("\n").map(((e,n)=>{const t=n+1;return o.lineNumbers.some((([e,n])=>e&&n?t>=e&&t<=n:t===e))?'<div class="highlighted">&nbsp;</div>':"<br/>"})).join("")}</div>${s}</div>`}};function j(e,n,t){let r=e;if(n&&h.default.getLanguage(n))try{r=h.default.highlight(e,{language:n,ignoreIllegals:!0}).value}catch(i){}else{const t=h.default.highlightAuto(e);r=t.value,n=t.language||""}return`<pre class="hljs" data-lang="${n}"><code>${r}</code></pre>`}function w(e){const n=new f.default(o({html:!0,linkify:!0,typographer:!0,highlight:j},e));return n.linkify.set({fuzzyLink:!1}),n.use(k),n.use(x),n.use($.default,o({permalink:$.default.permalink.linkInsideHeader({class:"anchor",symbol:'<span class="octicon octicon-link"></span>',placement:"before"}),slugify:e=>g.default(e)},e.anchor)),e&&e.setup&&e.setup(n),n}const O=/<template>([\s\S]+)<\/template>/g;function S(e){const n=e.match(/<(script)>([\s\S]+)<\/\1>/);return n&&n[2]?n[2].trim():""}function q(e){return(e=e.trim())?e.replace(/<(script|style)[\s\S]+<\/\1>/g,"").trim():e}function N(e,n){let t=e;O.test(t)&&(t=t.replace(O,"$1"));const r=m.compileTemplate({source:`<div>${t}</div>`,filename:"inline-component",compiler:m.TemplateCompiler,compilerOptions:{mode:"function"}});r.tips&&r.tips.length&&r.tips.forEach((e=>{console.warn(e)})),r.errors&&r.errors.length&&console.error(`\n  Error compiling template:\n${function(e){return e.split(/\r?\n/).map((e=>`  ${e}`)).join("\n")}(r.source)}\n`+r.errors.map((e=>`  - ${e}`)).join("\n")+"\n");let i=`\n    ${r.code.replace("return function render","function render")}\n  `;n=n.trim();const o="$$$blockDemoExport";return i=`(function() {\n    ${i}\n    ${n=n?n.replace(/export\s+default/,(()=>`const ${o} =`)).replace(/import ({.*}) from 'vue'/g,((e,n)=>`const ${n} = Vue`)):`const ${o} = {}`}\n    return {\n      render,\n      ...${o}\n    }\n  })()`,i}const E=w;function I(e,n,t={}){const r=n.render(e),i="\x3c!--element-demo:",o=i.length,s=":element-demo--\x3e",l=s.length,c=[];let a=0,u=[],p=0,m=r.indexOf(i),d=r.indexOf(s,m+o);for(;-1!==m&&-1!==d;){u.push(r.slice(p,m));const e=r.slice(m+o,d),n=q(e),t=S(e),f=`block-demo-${a}`;u.push(`<template #source><${f} /></template>`),c.push([JSON.stringify(f),N(n,t)]),a++,p=d+l,m=r.indexOf(i,p),d=r.indexOf(s,m+o)}u.push(r.slice(p));let f="",h="";const $=`\n    <template>\n      \x3c!-- eslint-disable --\x3e\n      <section class="markdown ${t.className||"content"}">\n      ${u.join("")}\n      </section>\n    </template>`.replace(/<script>([\s\S]+?)<\/script>/g,(function(e){if(!f)if(c.length>0){const n="$$$exportDefault",t="$$$componenetMixins",r=`const ${t} = {\n            components: {\n${c.map((e=>`${e[0]}: ${e[1]}`)).join(",\n")}\n}\n          }`,i=`if (${n}.mixins) {\n            ${n}.mixins.push(${t})\n          } else {\n            ${n}.mixins = [${t}]\n          }\n          `;f=e.replace(/export +default/,(()=>`const ${n} =`)).replace(/<\/script>/,(()=>`${r}\n${i}\nexport default ${n}\n<\/script>`))}else f=e;return""})).replace(/<style( +.*)?>([\s\S]+?)<\/style>/g,(function(e){return h=e,""}));return f||(f=`<script>\n      /** eslint-disable **/\n      import * as Vue from 'vue'\n      export default {\n        components: {\n          ${c.map((e=>e[0]+": "+e[1])).join(",\n")}\n        }\n      }\n    <\/script>`),[$,f,h].filter((e=>!!e)).join("\n")}exports.createMarkdown=E,exports.default=function(e={}){const n=s.createFilter(e.include||/\.md$/,e.exclude),t=w(e.markdown||{});return{name:"vite-plugin-markdown-vue",enforce:"pre",transform:async(r,i)=>n(i)?I(r,t,e):null,async handleHotUpdate(r){if(!n(r.file))return;const i=r.read;r.read=async function(){return I(await i(),t,e)}}}},exports.transformToVueCode=I;
